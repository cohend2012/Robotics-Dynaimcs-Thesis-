% Daniel Cohen 
clear all; clc;
format LONGE
t = 0:0.01:1;  
x0 = [1;0]
xf = [-2;-0.5]
 
A = [-2 ,0 ;0 -1] 
B = [1;1];
C=[1 0];
C2 = [0,1];
D = [0];
 
sys = ss(A, B,C,D)
 
W_0_1 = [(1/4)*exp(4)-(1/4) ,(1/3)*exp(3)-(1/3);(1/3)*exp(3)-(1/3), (1/2)*exp(2)-(1/2)]

u = (-2.*exp(2.*t)-1).*(1.3698.*exp(2.*t)-2.7279.*exp(1.*t))-0.5.*exp(1.*t).*(-2.7279.*exp(2.*t)+5.7457.*exp(1.*t))
syms t

S= syms

u = B.'*[exp(-A(1,1)*t), 0; 0, exp(-A(2,2).*t)]*inv(W_0_1)*([expm(-A(1,1)), 0; 0, exp(-A(2,2))]*xf-x0)
%u = B.'*[exp(-A(1,1)*t), 0; 0, exp(-A(2,2).*t)]*inv(W_0_1)*([exp(-A(1,1)*t), 0; 0, exp(-A(2,2).*t)].*xf-x0)
cellfun(@clear,S);
 
t = 0:0.01:1; 

%u1 = (exp(t).*((3071371175774827.*exp(2.*t))/1125899906842624 - (6469027322201697.*exp(t))/1125899906842624))/2 - ((771126959447357.*exp(2.*t))/562949953421312 - (3071371175774827.*exp(t))/1125899906842624).*(2.*exp(2.*t) + 1)
 

u =(89324663657494704006574611759443*exp(t))/2535301200456458802993406410752 - (45394998786252169909079509314825*exp(2*t))/2535301200456458802993406410752
 

figure 
set(gca,'Fontsize',20);
hold on 
y=lsim(sys,u,t,x0);
plot(t,y,'LineWidth',2); 
xlabel('Time (s)')
ylabel('x_1(t) and x_2(t)'); 
legend('x_1(t)','x_2(t)');

sys = ss(A, B,C2,D)
y=lsim(sys,u,t,x0);
plot(t,y,'LineWidth',2); 
xlabel('Time (s)')
ylabel('x_2(t)'); 
legend('x_2(t)');
